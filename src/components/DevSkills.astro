---
import { Icon } from 'astro-icon/components';

import SkillBar from '@components/SkillBar.astro';
import { TechnicalSkills } from '@/model';

const { value } = Astro.props;

const IconMap = {
	Language: 'ic:round-code-off',
	Framework: 'mdi:application-brackets-outline',
	Tools: 'ic:round-settings-suggest',
	Graphic: 'ic:round-draw',
};
const skillCategories: Map<string, TechnicalSkills[]> = value.reduce((acc, item: TechnicalSkills) => {
	const keywords = item.keywords?.map((keyword) => keyword.trim()) || [];
	keywords.forEach((keyword) => {
		if (Object.keys(IconMap).indexOf(keyword) !== -1) {
			if (acc.has(keyword)) {
				acc.set(keyword, [...acc.get(keyword), item]);
			} else {
				acc.set(keyword, [item]);
			}
		}
	});
	return acc;
}, new Map());

const skillList = Array.from(skillCategories.entries());
---

<section id="skills">
	<div class="text-center">
		<h1 class="mb-4 text-justify text-4xl font-extrabold leading-none tracking-tight md:text-5xl lg:text-6xl">
			Languages and Tools
		</h1>
		<div class="my-8 columns-2 gap-8 md:columns-3">
			{
				skillList.map(([label, item]) => (
					<div class="mb-12 break-inside-avoid">
						<div class="flex flex-col items-center gap-4 px-8">
							<Icon name={IconMap[label]} class="h-12 w-12" />
							<h2 class="font-bold">{label}</h2>
							{item.map(({ name, proficiency }) => (
								<SkillBar name={name} level={proficiency} />
							))}
						</div>
					</div>
				))
			}
		</div>
	</div>
</section>
